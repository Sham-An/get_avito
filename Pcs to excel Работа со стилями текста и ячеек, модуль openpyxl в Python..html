<!DOCTYPE html><html lang="ru"><head><title>Работа со стилями текста и ячеек, модуль openpyxl в Python.</title><meta charset="utf-8"><meta name="description" content="Модуль openpyxl обеспечивает довольно гибкое управление стилями, относительно простую работу с ними. Стили в электронных таблицах XLSX используются для изменения внешнего вида данных при отображении на экране. Они также используются для определения форматирования чисел."><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="theme-color" content="#e9e9e9"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="yandex-verification" content="7fc92983a5ae9810"><link rel="stylesheet" href="/static/css/min.css"><link rel="icon" type="image/svg" href="/favicon.svg"><meta property="og:image" content="/favicon.svg"><link rel="manifest" href="/packages/webapp.manifest"><style>.important-xl {min-height: calc(100vh - 140px);overflow:auto;}blockquote {padding-left: 1rem;font-style: italic;border-left: #6c757d 3px solid;}nav, aside {visibility:hidden;}footer div {background-color: #e9e9e9;}code {background-color: #eeeeee; color:rgb(17, 17, 17);font-size:87%;}pre{border:1px silver solid;padding:5px;font-size:85%;display:block;width:100%;background-color: #eeeeee;color:#212529}.crimson, h3>em>code,h4>em>code,h5>em>code{line-height:1.2;margin-top:15px;color:crimson;background-color:#e9e9e9;}.big{font-size:120%}.small{font-size:80%}.small-grey{font-size:75%; color: dimgrey;}.table-bordered td{font-size:90%;}.table-bordered .color td{background-color:#E0E0E0; font-size:110%;text-align:center;}div.highlight{margin-bottom: 1rem;}.breadcrumb {padding:2px 7px;margin-bottom:0px;font-size:85%;}.no-gutters>.col-lg-9{margin-top:15px;}.card-header,.card-body{padding:10px 5px 5px 5px;}.overflow-auto.card-body {max-height: 600px;}.card-body>ul{padding:5px 5px 5px 20px; font-size:85%;}ol,ul,.card-body>ul>li{margin-top:5px;}.hr{width:90%;border:rgb(166, 209, 166) 1px solid;}.illuminate,.illuminate code{background-color:rgb(255, 255, 115);transition: 1s ease;}div[id^='yandex_rtb_R-A']{margin-bottom:10px;}#back-to-top {position:fixed;bottom:25px;left:25px;display:none;z-index:1001;}#msg-email,#msg-error,#okay{cursor: pointer;}#scroll{transition: 1s linear;}.blinking {background-color: rgb(51, 161, 51);}@media(max-width:768px){#container-msg-error {text-align:left !important;}}@media (max-width: 540px) {body{font-size:1.05rem !important;}pre{font-size:90%;}}#scroll::-webkit-scrollbar-track {-webkit-box-shadow: inset 0 0 6px rgba(0, 0, 0, 0.3);background-color: #f5f5f5;}#scroll::-webkit-scrollbar {width: 3px;background-color: #f5f5f5;}#scroll::-webkit-scrollbar-thumb {background-color: #6c757d;}</style><link rel="dns-prefetch" href="//yastatic.net/"><link rel="dns-prefetch" href="//mc.yandex.ru/"><link rel="dns-prefetch" href="//yandex.ru/"><script>window.yaContextCb=window.yaContextCb||[]</script><script async src="https://yandex.ru/ads/system/context.js"></script><script>window.yaContextCb.push(()=>{Ya.Context.AdvManager.render({type: 'floorAd',blockId: 'R-A-1582037-6'})})</script></head><body><div class="container-xl"><header><nav class="navbar navbar-expand-lg navbar-light rounded border" style="background-color: #e9e9e9;"><a class="navbar-brand" href="/" title="Python3, наиболее полный справочник и самоучитель.">DOCS Python3</a><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav mr-auto"><li class="nav-item "><a class="nav-link" href="/tutorial/" title="Справочник по языку Python3 на русском языке">Справочник Python</a></li><li class="nav-item "><a class="nav-link" href="/standart-library/" title="Документация по стандартной библиотеки языка Python3">Стандартная библиотека</a></li><li class="nav-item active"><a class="nav-link" href="/packages/" title="Сторонние популярные пакеты и модули">Другие модули</a></li><li class="nav-item "><a class="nav-link text-danger" href="/search/">Поиск</a></li><li class="nav-item"><span class="nav-link" id="msg-email">Контакты</span></li></ul></div></nav></header></div><div class="container-xl"><div class="row no-gutters"><div class="col-sm-12 col-md-6"><div class="ya-share2" data-services="vkontakte,odnoklassniki,messenger,whatsapp,viber,telegram,pocket,moimir"></div></div><div id="container-msg-error" class="col-sm-12 col-md-6 text-right"><span id="msg-error" class="badge badge-warning">Сообщить об ошибке.</span></div></div></div><div class="important-xl"><h1 class="text-center mt-3">Работа со стилями текста и ячеек, модуль openpyxl в Python.</h1><div id="important-info"><div id="yandex_rtb_R-A-1582037-2"></div><script>window.yaContextCb.push(()=>{Ya.Context.AdvManager.render({blockId: 'R-A-1582037-2',renderTo: 'yandex_rtb_R-A-1582037-2',})})</script></div><nav aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="/packages/" title="Часто используемые в Python3 сторонние модули.">Сторонние пакеты и модули Python3.</a></li><li class="breadcrumb-item"><a href="/packages/modul-openpyxl/" title="Работа с файлами XLSX при помощи модуля openpyxl#.">Модуль openpyxl в Python, работа с файлами XLSX.</a></li><li class="breadcrumb-item active" aria-current="page">Работа со стилями текста и ячеек, модуль openpyxl в Python.</li></ol></nav><div class="row no-gutters"><div class="col-lg-9 pr-lg-1"><p><a href="/packages/modul-openpyxl/" title="Модуль openpyxl в Python, работа с файлами XLSX.">Модуль <code>openpyxl</code></a> обеспечивает довольно гибкое управление стилями, относительно простую работу с ними. <a href="/packages/modul-openpyxl/rabota-stiljami/" title="Работа со стилями текста и ячеек, модуль openpyxl в Python.">Стили в электронных таблицах XLSX</a> используются для изменения внешнего вида данных при отображении на экране. Они также используются для определения форматирования чисел.</p><h3><u>Содержание</u>:</h3><ul><li><a href="#default">Аспекты применения стилей модулем <code>openpyxl</code></a>.</li><li><a href="#style">Cтили ячеек электронной таблицы</a>.<ul><li><a href="#copy-style">Создания нового стиля на основе другого</a>.</li><li><a href="#color-style">Цвета для шрифтов, фона, границ</a>.</li><li><a href="#apply-style">Применение стилей</a>.</li><li><a href="#style-alignment">Горизонтальное и вертикальное выравнивание текста</a>.</li><li><a href="#style-border">Оформление границ ячеек</a>.</li><li><a href="#style-fill">Заливка ячеек цветом и цвет текста</a>.</li></ul></li><li><a href="#style-name">Именованные стили <code>NamedStyle</code></a>.<ul><li><a href="#create-style-name">Создание именованного стиля</a>.</li></ul></li><li><a href="#excel-style-name">Встроенные в Excel стили</a>.</li></ul><hr><p><a id="default"></a></p><h2>Аспекты применения стилей модулем <code>openpyxl</code>.</h2><p><u>Стили могут быть применены к следующим аспектам</u>:</p><ul><li><code>font</code>: устанавливает размер шрифта, цвет, стиль подчеркивания и т. д.</li><li><code>fill</code>: устанавливает шаблон или градиент цвета заливки ячейки.</li><li><code>border</code>: устанавливает стиль границы ячейки.</li><li><code>alignment</code>: устанавливает выравнивание ячейки.</li></ul><p><u>Ниже приведены значения по умолчанию установленные модулем <code>openpyxl</code></u>:</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="p">(</span>
                        <span class="n">PatternFill</span><span class="p">,</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span><span class="p">,</span> 
                        <span class="n">Alignment</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">GradientFill</span>
                        <span class="p">)</span>

<span class="c1"># СТИЛЬ ШРИФТА</span>
<span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Calibri&#39;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
        <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">italic</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">vertAlign</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">underline</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
        <span class="n">strike</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span>
            <span class="p">)</span>

<span class="c1"># ЗАЛИВКА ЯЧЕЕК</span>
<span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">fill_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fgColor</span><span class="o">=</span><span class="s1">&#39;FFFFFFFF&#39;</span><span class="p">)</span>

<span class="c1"># ГРАНИЦЫ ЯЧЕЕК</span>
<span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span>
            <span class="n">left</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">right</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">top</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">bottom</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">diagonal</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">diagonal_direction</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
            <span class="n">outline</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">vertical</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">),</span>
            <span class="n">horizontal</span><span class="o">=</span><span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF000000&#39;</span><span class="p">)</span>
               <span class="p">)</span>

<span class="c1"># ВЫРАВНИВАНИЕ В ЯЧЕЙКАХ</span>
<span class="n">alignment</span><span class="o">=</span><span class="n">Alignment</span><span class="p">(</span>
                <span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;general&#39;</span><span class="p">,</span>
                <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                <span class="n">text_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">wrap_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">shrink_to_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">indent</span><span class="o">=</span><span class="mi">0</span>
                   <span class="p">)</span>
</pre></div><p><a id="style"></a></p><h2>Cтили ячеек электронной таблицы.</h2><p>Существует два типа стилей: <a href="#style">стили ячеек</a> и именованные стили, также известные как <a href="#style-name">шаблоны стилей</a>.</p><p>Стили ячеек являются общими для объектов, и после того, как они были назначены, их нельзя изменить. Это предотвращает нежелательные побочные эффекты, такие как изменение стиля для большого количества ячеек при изменении только одной.</p><p>Например: </p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Color</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Ячейка `A1`&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Ячейка `D4`&#39;</span>
<span class="c1"># задаем стиль шрифта текста - цвет  ячейке</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;FF0000&quot;</span><span class="p">)</span>
<span class="c1"># применяем стиль к ячейкам</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ft</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">ft</span>
<span class="c1"># это изменение не сработает</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span><span class="o">.</span><span class="n">italic</span> <span class="o">=</span> <span class="kc">True</span> 
<span class="c1"># Если необходимо изменить шрифт, </span>
<span class="c1"># то его необходимо переназначить новым стилем</span>
<span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;FF0000&quot;</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
</pre></div><p><a id="copy-style"></a></p><h3>Создания нового стиля на основе другого.</h3><p>Модуль <code>openpyxl</code> поддерживает копирование стилей. </p><p>Пример создания нового стиля на основе другого:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">copy</span>
<span class="c1"># задаем стиль</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft1</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># копируем стиль</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft2</span> <span class="o">=</span> <span class="n">copy</span><span class="p">(</span><span class="n">ft1</span><span class="p">)</span>
<span class="c1"># а вот теперь на основе скопированного стиля </span>
<span class="c1"># можно создать новый, изменив атрибуты </span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft2</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Tahoma&quot;</span>
<span class="c1"># имя шрифта первого стиля</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft1</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># &#39;Arial&#39;</span>

<span class="c1"># имя шрифта нового стиля</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft2</span><span class="o">.</span><span class="n">name</span>
<span class="c1"># &#39;Tahoma&#39;</span>

<span class="c1"># размер остался как у первого</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ft2</span><span class="o">.</span><span class="n">size</span> <span class="c1"># copied from the</span>
<span class="c1"># 14.0</span>
</pre></div><p><a id="color-style"></a></p><h3>Цвета для шрифтов, фона, границ.</h3><p>Цвета для шрифтов, фона, границ и т.д. Можно задать тремя способами: индексированный, aRGB или тема. Индексированные цвета являются устаревшей реализацией, и сами цвета зависят от индекса, предоставленного в рабочей книге или в приложении по умолчанию. Цвета темы полезны для дополнительных оттенков цветов, но также зависят от темы, присутствующей в рабочей книге. Поэтому рекомендуется использовать цвета aRGB.</p><h4>Цвета aRGB.</h4><p>Цвета RGB устанавливаются с использованием шестнадцатеричных значений красного, зеленого и синего.</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;FF0000&quot;</span><span class="p">)</span>
</pre></div><p>Альфа-значение теоретически относится к прозрачности цвета, но это не относится к стилям ячеек. Значение по умолчанию <code>00</code> будет добавлено к любому простому значению RGB:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;00FF00&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">rgb</span>
<span class="c1"># &#39;0000FF00&#39;</span>
</pre></div><p><a id="apply-style"></a></p><h3>Применение стилей.</h3><p>Стили применяются непосредственно к ячейкам.</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">PatternFill</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Ячейка `A1`&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1"># можно напрямую</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Ячейка `A2`&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
</pre></div><p>Стили также могут применяться к столбцам и строкам, но обратите внимание, что это относится только к ячейкам, созданным (в Excel) после закрытия файла. Если необходимо применить стили ко всем строкам и столбцам, то нужно применить стиль к каждой ячейке самостоятельно. </p><p>Это ограничение формата файла:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">col</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">col</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">row</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">row</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">underline</span><span class="o">=</span><span class="s2">&quot;single&quot;</span><span class="p">)</span>
</pre></div><p><a id="style-alignment"></a></p><h3>Горизонтальное и вертикальное выравнивание текста.</h3><p>Горизонтальное и вертикальное выравнивание в ячейках выставляется атрибутом ячейки <code>.alignment</code> и <a href="#default">классом <code>Alignment()</code></a>.</p><p>Пример горизонтального выравнивания текста:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Alignment</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1500</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1500</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mi">1500</span>
<span class="c1"># выравниваем текст в ячейках стилями</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>
<span class="c1"># сохраняем и смотрим что получилось</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;test.xlsx&#39;</span><span class="p">)</span>
</pre></div><p>Вертикальное выравнивание в основном применяется когда <a href="/packages/modul-openpyxl/razmer-stroki-stolbtsa/" title="Как изменить размеры строки/столбца модулем openpyxl в Python.">изменена высота строки</a> или были <a href="/packages/modul-openpyxl/obedinit-razedinit-jachejki/" title="Как объединить/разъединить ячейки, модулем openpyxl в Python.">объединены несколько ячеек</a>.</p><p>Пример вертикального выравнивания данных в ячейке:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Alignment</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="c1"># объединим ячейки в диапазоне `B2:E2`</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="s1">&#39;B2:E2&#39;</span><span class="p">)</span>
<span class="c1"># в данном случае крайняя верхняя-левая ячейка это `B2`</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span>
<span class="c1"># запишем в нее текст</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Объединенные ячейки `B2 : E2`&#39;</span>
<span class="c1"># установить высоту строки</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
<span class="c1"># установить ширину столбца</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># выравнивание текста</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
<span class="c1"># сохраняем и смотрим что получилось</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;test.xlsx&quot;</span><span class="p">)</span>
</pre></div><p><a id="style-border"></a></p><div id="yandex_rtb_R-A-1582037-3"></div><script>window.yaContextCb.push(()=>{Ya.Context.AdvManager.render({blockId: 'R-A-1582037-3',renderTo: 'yandex_rtb_R-A-1582037-3',})})</script><h2>Оформление границ ячеек.</h2><p>Цвет и стиль границ/бордюров ячеек выставляется атрибутом ячейки <code>.border</code> и <a href="#default">классом <code>Border()</code> совместно с классом <code>Side()</code></a>.</p><p>При этом аргумент стиля границ ячеек <code>border_style</code> может принимать ОДИН из следующих значений:  <code>‘dashDotDot’</code>, <code>‘medium’</code>, <code>‘dotted’</code>, <code>‘slantDashDot’</code>, <code>‘thin’</code>, <code>‘hair’</code>, <code>‘mediumDashDotDot’</code>, <code>‘dashDot’</code>, <code>‘double’</code>, <code>‘mediumDashed’</code>, <code>‘dashed’</code>, <code>‘mediumDashDot’</code> и <code>‘thick’</code>.</p><p>Пример стилизации границ одной ячейки:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span>
<span class="c1"># установить высоту строки</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
<span class="c1"># установить ширину столбца</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># определим стили сторон</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">thins</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;medium&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0000ff&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">double</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;dashDot&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;ff0000&quot;</span><span class="p">)</span>
<span class="c1"># рисуем границы</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">cell</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">thins</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span> 
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;styled_border.xlsx&quot;</span><span class="p">)</span>
</pre></div><p>Пример стилизации границ нескольких ячеек:</p><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

<span class="c1"># определим стили сторон</span>
<span class="n">thins</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;thin&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0000ff&quot;</span><span class="p">)</span>
<span class="n">double</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">border_style</span><span class="o">=</span><span class="s2">&quot;double&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;ff0000&quot;</span><span class="p">)</span>

<span class="c1"># начинаем заполнение области ячеек 10x10 данными</span>
<span class="c1"># при этом будем стилизировать границы области </span>
<span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">15</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># это значение, которое будем записывать в ячейку</span>
        <span class="n">val_cell</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">c</span>
        <span class="c1"># левая верхняя ячейка</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="c1"># правая верхняя ячейка</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="c1"># верхние ячейки</span>
        <span class="k">if</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="n">double</span><span class="p">)</span>
        <span class="c1"># левая нижняя ячейка</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="c1"># правая нижняя ячейка</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">double</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="c1"># нижние ячейки</span>
        <span class="k">elif</span> <span class="n">r</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">c</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="n">double</span><span class="p">)</span>
        <span class="c1"># левые ячейки</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="c1"># правые ячейки</span>
        <span class="k">elif</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">10</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">r</span> <span class="o">!=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="n">thins</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># здесь ячейки просто заполняются данными</span>
            <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">row</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">val_cell</span><span class="p">)</span>

<span class="c1"># сохраняем и смотрим что получилось</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;styled_border.xlsx&quot;</span><span class="p">)</span>
</pre></div><p><a id="style-fill"></a></p><h2>Заливка ячеек цветом и цвет текста.</h2><p>Цвет заливки ячеек выставляется атрибутом ячейки <code>.fill</code> и  <a href="#default">классом <code>PatternFill()</code></a>.</p><p>Обязательный аргумент <code>fill_type</code> (по умолчанию равен <code>None</code>) класса <code>PatternFill()</code> может принимать значения: </p><ul><li>если <code>fill_type=&#39;solid&#39;</code>, то нужно обязательно указывать аргумент цвета заливки <code>fgColor</code>.</li><li>следующие значения аргумента <code>fill_type</code> применяются самостоятельно (без аргумента <code>fgColor</code>) и представляют собой предустановленные цвета заливки : <code>‘darkHorizontal’</code>, <code>‘lightDown’</code>, <code>‘lightGray’</code>, <code>‘darkDown’</code>, <code>‘darkGrid’</code>, <code>‘darkUp’</code>, <code>‘darkGray’</code>, <code>‘darkVertical’</code>, <code>‘darkTrellis’</code>, <code>‘mediumGray’</code>, <code>‘lightVertical’</code>, <code>‘lightTrellis’</code>, <code>‘lightGrid’</code>, <code>‘lightHorizontal’</code>, <code>‘gray0625’</code>, <code>‘lightUp’</code>, <code>‘gray125’</code>.</li></ul><p><strong>Внимание</strong>: если аргумент <code>fill_type</code> не указан, то <code>fgColor</code> не будет иметь никакого эффекта!</p><p>Пример заливки одной ячейки:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl</span> <span class="kn">import</span> <span class="n">Workbook</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">PatternFill</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Alignment</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span> <span class="o">=</span> <span class="n">Workbook</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="c1"># объединим ячейки в диапазоне `B2:E2`</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="s1">&#39;B2:E2&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span>
<span class="c1"># запишем в нее текст</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s1">&#39;Объединенные ячейки `B2 : E2`&#39;</span>
<span class="c1"># установить высоту строки</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">row_dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="mi">30</span>
<span class="c1"># установить ширину столбца</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="o">.</span><span class="n">column_dimensions</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="mi">40</span>
<span class="c1"># заливка ячейки цветом</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="s1">&#39;solid&#39;</span><span class="p">,</span> <span class="n">fgColor</span><span class="o">=</span><span class="s2">&quot;DDDDDD&quot;</span><span class="p">)</span>
<span class="c1"># шрифт и цвет текста ячейки </span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;FF0000&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Arial&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># ну и для красоты выровним текст</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">megre_cell</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="c1"># сохраняем и смотрим что получилось</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;cell_color.xlsx&quot;</span><span class="p">)</span>
</pre></div><p><a id="style-name"></a></p><h2>Именованные стили <code>NamedStyle</code>.</h2><p>В отличие от <a href="#style">простых стилей ячеек</a>, именованные стили изменяемы и используется для объединения в себе нескольких стилей, таких как шрифты, границы, выравнивание и т. д. Они имеют смысл, когда необходимо применить форматирование к множеству разных ячеек одновременно. Об именованных стилях можно думать как о классах CSS при оформлении HTML-разметки. Именованные стили регистрируются в рабочей книге.</p><p><strong>Примечание</strong>. После назначения ячейке именованного стиля, дальнейшие/дополнительные изменения этого стиля не повлияют на стиль ячейки.</p><p>Как только именованный стиль зарегистрирован в рабочей книге, на него можно ссылаться просто по имени.</p><p><a id="create-style-name"></a></p><h3>Создание именованного стиля.</h3><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">NamedStyle</span><span class="p">,</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Border</span><span class="p">,</span> <span class="n">Side</span>
<span class="c1"># создание переменной именованного стиля</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">name_style</span> <span class="o">=</span> <span class="n">NamedStyle</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;highlight&quot;</span><span class="p">)</span>
<span class="c1"># применение стилей к созданной переменной</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">name_style</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">bd</span> <span class="o">=</span> <span class="n">Side</span><span class="p">(</span><span class="n">style</span><span class="o">=</span><span class="s1">&#39;thick&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;000000&quot;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">name_style</span><span class="o">.</span><span class="n">border</span> <span class="o">=</span> <span class="n">Border</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">bd</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bd</span><span class="p">)</span>
</pre></div><p>После создания именованного стиля его нужно зарегистрировать в рабочей книге:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">wb</span><span class="o">.</span><span class="n">add_named_style</span><span class="p">(</span><span class="n">name_style</span><span class="p">)</span>
</pre></div><p>Именованные стили также будут автоматически зарегистрированы при первом назначении их ячейке:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;A1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="n">name_style</span>
</pre></div><p>После регистрации стиля в рабочей книге, применять его можно только по имени:</p><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span> <span class="n">ws</span><span class="p">[</span><span class="s1">&#39;D5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="s1">&#39;highlight&#39;</span>
</pre></div><p><a id="excel-style-name"></a></p><h2>Встроенные стили в Excel.</h2><p>Спецификация включает в себя некоторые встроенные стили, которые также могут быть использованы. К сожалению, имена для этих стилей хранятся в их локализованных формах. <code>OpenPyxl</code> узнает только английские имена и только так, как они записаны в официальной документации. </p><p>Использование встроенных в Excel стилей здесь не рассматривается, так как при их применении могу возникать существенные искажения.</p></div><div class="col-lg-3"><aside class="card shadow-sm border-secondary mb-2"><div class="card-header text-center bg-secondary text-white"><h4 class="h4">Содержание раздела:</h4></div><div id="scroll" class="overflow-auto card-body"><ul><li><a  href="/packages/modul-openpyxl/brief-description/" title="Краткий обзор раздела: Модуль openpyxl в Python, работа с файлами XLSX.">КРАТКИЙ ОБЗОР МАТЕРИАЛА.</a></li><li><a  href="/packages/modul-openpyxl/vstroennye-excel-formuly/" title="Встроенные в Excel формулы и модуль openpyxl в Python.">Встроенные в Excel формулы и модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/format-jacheek/" title="Установка формата ячеек Excel при помощи openpyxl.">Как установить формат в ячейку Excel модулем openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/obedinit-razedinit-jachejki/" title="Объединить/разъединить ячейки модулем openpyxl.">Как объединить/разъединить ячейки, модулем openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/razmer-stroki-stolbtsa/" title="Изменение размеров строки/столбца модулем openpyxl в Python.">Как изменить размеры строки/столбца модулем openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/zakrepit-stroki-stolbtsy-shapku/" title="Фиксация строк/столбцов в качестве шапки при помощи openpyxl.">Как закрепить строки/столбцы как шапку, модулем openpyxl.</a></li><li><a class=text-muted href="/packages/modul-openpyxl/rabota-stiljami/" title="Работа со стилями текста и ячеек, модуль openpyxl в Python.">Работа со стилями текста и ячеек, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/parametry-prosmotra-pechati/" title="Параметры печати и просмотра документа в Excel.">Настройка печати/просмотра документа в Excel модулем openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/vstavka-udalenie-strok-stolbtsov-peremeschenie-jacheek/" title="Вставка/удаление строк/столбцов, перемещение диапазона ячеек.">Вставка/удаление строк и столбцов, перемещение ячеек, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/obrabotka-bolshih-fajlov-xlsx/" title="Обработка больших файлов XLSX модулем openpyxl в Python.">Обработка больших файлов XLSX модулем openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/rabota-pandas-numpy/" title="Работа с Pandas и поддержка NumPy, модуль openpyxl в Python.">Работа с Pandas и поддержка NumPy, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/proverka-dannyh-zapolnenii-jacheek/" title="Средства проверки данных при заполнении в ячеек.">Проверка данных при заполнении ячеек, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/imenovannye-diapazony-jacheek/" title="Определенные имена для доступа к диапазонам ячеек.">Именованные диапазоны ячеек в модуле openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/obekt-worksheet-table/" title="Работа c таблицами рабочих листов модуля openpyxl.">Работа с объектом Table() модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/zaschita-knigi-rabochego-lista/" title="Защита книги и рабочего листа, модуля openpyxl в Python.">Защита книги и рабочего листа, модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/dobavlenie-izobrazhenij/" title="Добавление изображений в XLSX-документ.">Добавление изображений в XLSX-документ, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/stil-jacheek-usloviju/" title="Наложение стиля ячеек по условию.">Стиль ячеек по условию, модуль openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/sozdanie-diagramm/" title="Создание диаграмм средствами модуля openpyxl в Python.">Создание диаграмм средствами модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/klass-workbook/" title="Основные атрибуты и методы объекта Workbook().">Класс Workbook() модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/obekt-worksheet/" title="Основные атрибуты и методы объекта Worksheet.">Объект Worksheet модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/obekt-jachejki-cell/" title="Основные атрибуты и методы объекта ячейки Cell.">Объект ячейки Cell модуля openpyxl.</a></li><li><a  href="/packages/modul-openpyxl/funktsii-preobrazovanija/" title="Функции преобразования ячеек модуля openpyxl в Python.">Функции преобразования ячеек модуля openpyxl.</a></li></ul></div></aside><div id="right-row"><div id="yandex_rtb_R-A-1582037-1"></div><script>window.yaContextCb.push(()=>{Ya.Context.AdvManager.render({renderTo: 'yandex_rtb_R-A-1582037-1',blockId: 'R-A-1582037-1'})})</script></div></div></div><div id="dialogModal"></div></div><div class="container-xl"><footer><div id="back-to-top" class="btn btn-info">Вверх</div><div id="footer" class="card rounded"><div class="card-body"><p class="card-text"><a href="/" title="Справочная документация по языку Python3.">DOCS-Python.ru</a>™, 2022 г. <span class="small text-secondary">(<span class="text-danger">Внимание!</span> При копировании материала ссылка на источник обязательна)</span></p></div></div></footer></div><script src="/static/js/min.js"></script><script>var ublock;function getStyle(sel) {var sayings = new Map();sayings.set("display", "none").set("visibility", "hidden").set("position", "absolute");for (var [key, value] of sayings) {if ($(sel).css(key) == value) return true;if ($(sel).children().css(key) == value) return true;}}function sendError(msg, comment, h1) {$.ajax({type: "POST",url: "/send/error/",data: {'msg':msg, 'comment':comment, 'h1':h1},success: function(data) {var a = data.split('|');var resp = a.pop();if (resp.indexOf('ok') == 0) {Cookies.set('msgErr', '0');$('#errSend').remove();a.forEach(function(item) {b = item.split('#', 2);$('#'+b[0]).html(b[1]);});} else if (resp.indexOf('fatal') == 0) {$('#errSend').remove();a.forEach(function(item) {b = item.split('#', 2);$('#'+b[0]).html(b[1]);});} else {$('#errSend').text('Отправить').attr('disabled', false);$('#errTitle').css("color", "red").html(a.join('<br>'));}}});}function sendEmail(user, email, subject, msg) {$.ajax({type: "POST",url: "/send/email/",data: {'user':user, 'email':email, 'subject':subject, 'msg':msg},success: function(data){var a = data.split('|');var resp = a.pop();if (resp.indexOf('ok') == 0) {$('#emailSend').remove();a.forEach(function(item) {b = item.split('#', 2);$('#'+b[0]).html(b[1]);});} else if (resp.indexOf('fatal') == 0) {$('#emailSend').remove();a.forEach(function(item) {b = item.split('#', 2);$('#'+b[0]).html(b[1]);});} else {$('#emailSend').text('Отправить').attr('disabled', false);$('#emailTitle').css("color", "brown").text('Исправте ошибки в письме.');a.forEach(function(item) {b = item.split('#');$('#'+b[0]).css("background-color", "rgb(252, 228, 228)");$('#_'+b[0]).text(b[1])});}}});}$(document).ready(function(){var h1 = $('h1').text();var doc_width = $(document).width();$(window).on('load', function () {setTimeout(function(){ublock = 'false';var v = getStyle('div[id*="1582037"]');if(typeof yandex_context_callbacks=='undefined'||v===true) {ublock = 'true';$('nav,aside').remove();$('pre,code').parent().removeClass();if (doc_width > 972) {$.get("/static/form/donate.html", function(data) {$('#right-row').html(data);setTimeout(function(){if (getStyle('#donate')===true && doc_width > 972){ublock = 'fack';$('h1,h2,h3,h4,p,li,a').css('color','#dbdbdb').removeClass();$('pre,code').css('color','#fff').parent().removeClass();$('#msg-error').remove();$('.ya-share2').remove();}}, 200);});}} else {$('nav,aside').css('visibility','visible');}if (doc_width < 800) {if (ublock == 'true') {$('h1,h2,h3,h4,p,li,a').css('color','#dbdbdb').removeClass();$('pre,code').css('color','#fff').parent().removeClass();$('#msg-error').remove();$('.ya-share2').remove();} else if (ublock == 'false') {$('#right-row').css('position', 'static').remove('id');}}}, 1000);$(function() {var box = $('#right-row'); var top = box.offset().top;var width = box.width();$(document).on('scroll', function(){var windowpos = $(window).scrollTop();if(windowpos < top) {box.css('position', 'static');} else {box.css('position', 'fixed');box.css('width', width).css('top', 0);}});});});$(document).scroll(function() {if ($(this).scrollTop() > 300) {$('#back-to-top').fadeIn();} else {$('#back-to-top').fadeOut();}});$('#back-to-top').click(function () {$('body,html').animate({scrollTop: 0}, 200);return false;});$("a[href^='#']").click(function(){$('.illuminate').removeClass('illuminate');var href = $(this).attr('href').replace('#', '');var el_a = $("a[id='" + href + "']");$("html, body").animate({scrollTop: el_a.offset().top + "px"}, 200);el_a.parent().next().addClass("illuminate");return false;});$('#msg-error').click(function() {$('.modal-backdrop').removeClass('show').hide();$("#dialogModal").html('');$("#dialogModal").load("/static/form/modalError.html", function(response,status,xhr) {if(status == "success") {$("#dialogModal").html(response);$('#modalError').modal('show');$('#errPageName').text(h1);}});});$('#dialogModal').on('click', '#errSend', function() {$('#errSend').text('Идет отправка').attr('disabled', true);$('#emailTitle').css("color", "black").text('Ждите. Идет отправка...');var msg = $('#errText').val();var comment = $('#errCommentText').val();sendError(msg, comment, h1);});$('#msg-email').click(function() {$('.modal-backdrop').removeClass('show').hide();$("#dialogModal").html('');$("#dialogModal").load("/static/form/modalEmail.html", function(response,status) {if(status == "success") {$("#dialogModal").html(response);$('#modalEmail').modal('show');}});});$('#dialogModal').on('click', '#emailSend', function() {$('#emailSend').text('Идет отправка').attr('disabled', true);$('#emailTitle').css("color", "black").text('Ждите. Идет отправка...');var user = $('#user').val();var email = $('#email').val();var subject = $('#subject').val();var msg = $('#msg').val();sendEmail(user, email, subject, msg);});var right_menu = $("#scroll>ul>li:first").text();if (doc_width < 972 && right_menu) {var razdel = $(".breadcrumb-item:eq(1)").text().replace('.', ':');$('#navbarSupportedContent>ul>li:last').text(razdel);$("#scroll>ul").insertAfter('#navbarSupportedContent>ul>li:last');$('aside').remove();}});</script><script type="text/javascript" >(function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};m[i].l=1*new Date();for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");ym(67309303, "init", {clickmap:true,trackLinks:true,accurateTrackBounce:true});</script><noscript><div><img src="https://mc.yandex.ru/watch/67309303" style="position:absolute; left:-9999px;" alt="" /></div></noscript><script src="//yastatic.net/share2/share.js"></script></body></html>